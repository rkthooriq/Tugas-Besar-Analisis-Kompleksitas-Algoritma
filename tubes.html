<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Analisis 0/1 Knapsack Problem (Tubes Final)</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        /* --- CSS STYLING PROFESIONAL --- */
        * { margin: 0; padding: 0; box-sizing: border-box; }
        body { font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif; background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); min-height: 100vh; padding: 20px; }
        .container { max-width: 1400px; margin: 0 auto; background: white; border-radius: 20px; box-shadow: 0 20px 60px rgba(0,0,0,0.3); overflow: hidden; }
        .header { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 40px; text-align: center; }
        .header h1 { font-size: 28px; margin-bottom: 10px; }
        .content { padding: 40px; }
        .section { margin-bottom: 40px; border-bottom: 1px solid #eee; padding-bottom: 30px; }
        .section h2 { color: #667eea; margin-bottom: 20px; font-size: 24px; border-left: 5px solid #667eea; padding-left: 15px; }
        
        /* Input Panel */
        .config-panel { background: #f8f9fa; padding: 20px; border-radius: 10px; display: flex; gap: 20px; flex-wrap: wrap; align-items: flex-end; margin-bottom: 20px; border: 1px solid #e9ecef; }
        .input-wrapper { display: flex; flex-direction: column; flex: 1; min-width: 150px; }
        .input-wrapper label { font-weight: 600; margin-bottom: 5px; color: #555; font-size: 14px; }
        .input-wrapper input { padding: 10px; border: 2px solid #ddd; border-radius: 6px; font-size: 16px; }
        
        /* Buttons */
        .btn { background: linear-gradient(135deg, #667eea 0%, #764ba2 100%); color: white; padding: 12px 25px; border: none; border-radius: 8px; font-size: 15px; font-weight: 600; cursor: pointer; transition: transform 0.2s; height: 46px; margin-right: 10px; }
        .btn:hover { transform: translateY(-2px); box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4); }
        .btn-green { background: linear-gradient(135deg, #43e97b 0%, #38f9d7 100%); color: #054d33; }
        
        /* Results & Chart */
        .results { display: grid; grid-template-columns: repeat(auto-fit, minmax(300px, 1fr)); gap: 20px; margin-top: 20px; }
        .result-card { background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%); padding: 25px; border-radius: 15px; color: white; box-shadow: 0 5px 15px rgba(0,0,0,0.1); }
        .result-value { font-size: 28px; font-weight: bold; margin: 10px 0; }
        .chart-container { background: white; padding: 10px; border-radius: 10px; height: 450px; position: relative; }
        
        /* Tables */
        .comparison-table { width: 100%; border-collapse: collapse; margin-top: 20px; font-size: 14px; }
        .comparison-table th { background: #667eea; color: white; padding: 12px; text-align: left; }
        .comparison-table td { padding: 10px; border-bottom: 1px solid #ddd; }
        .comparison-table tr:hover { background: #f8f9fa; }
        
        .loading { display: none; text-align: center; padding: 20px; color: #667eea; font-weight: 600; }
        .loading.active { display: block; }
        .selected-items { background: #e7f3ff; padding: 15px; border-radius: 8px; margin-top: 15px; }
        .items-grid { display: grid; grid-template-columns: repeat(auto-fill, minmax(180px, 1fr)); gap: 10px; margin-top: 15px; }
        .mini-card { background: white; padding: 10px; border: 1px solid #ddd; border-radius: 5px; }
        .mini-card input { width: 100%; margin-top: 5px; padding: 5px; }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <h1>Analisis Perbandingan Algoritma</h1>
            <p>0/1 Knapsack Problem: Rekursif vs Iteratif (Dynamic Programming)</p>
        </div>

        <div class="content">
            
            <div class="section">
                <h2>1. Demo Algoritma (Pembuktian Logika)</h2>
                <p style="margin-bottom: 15px; color: #666;">Gunakan bagian ini untuk membuktikan bahwa kode benar-benar berjalan mencari solusi optimal.</p>
                
                <div class="config-panel">
                    <div class="input-wrapper">
                        <label>Jumlah Barang (Kecil):</label>
                        <input type="number" id="demoN" value="5" max="20">
                    </div>
                    <div class="input-wrapper">
                        <label>Kapasitas Truk:</label>
                        <input type="number" id="demoCapacity" value="50">
                    </div>
                    <div>
                        <button class="btn" onclick="generateItems()">Acak Barang</button>
                        <button class="btn btn-green" onclick="runRealAlgorithm()">Jalankan Algoritma Asli</button>
                    </div>
                </div>

                <div id="itemsContainer" class="items-grid"></div>
                <div id="realResults" class="results"></div>
            </div>

            <div class="section">
                <h2>2. Benchmark & Analisis (Simulasi Teoretis)</h2>
                <p style="margin-bottom: 15px; color: #666;">Gunakan bagian ini untuk menunjukkan performa pada data besar (N > 30) tanpa membuat browser hang.</p>

                <div class="config-panel">
                    <div class="input-wrapper">
                        <label>Mulai N:</label>
                        <input type="number" id="startN" value="100" min="100">
                    </div>
                    <div class="input-wrapper">
                        <label>Sampai N:</label>
                        <input type="number" id="endN" value="1000" max="1000">
                    </div>
                    <div class="input-wrapper">
                        <label>Kapasitas (W):</label>
                        <input type="number" id="simCapacity" value="50">
                    </div>
                    <button class="btn" onclick="runBenchmarkSimulation()">Mulai Analisis Grafik</button>
                </div>
                
                <div class="loading" id="loading">
                    <p>⏳ Sedang menghitung estimasi kompleksitas...</p>
                </div>

                <div class="chart-container">
                    <canvas id="timeChart"></canvas>
                </div>

                <div style="margin-top: 30px;">
                    <h3>Data Detail</h3>
                    <table class="comparison-table">
                        <thead>
                            <tr>
                                <th>N</th>
                                <th>Rekursif (Estimasi)</th>
                                <th>Iteratif (Estimasi)</th>
                                <th>Kesimpulan</th>
                            </tr>
                        </thead>
                        <tbody id="comparisonBody"></tbody>
                    </table>
                </div>

                <div id="analysisText" style="margin-top: 20px;"></div>
            </div>
        </div>
    </div>

    <script>
        // --- LOGIKA ALGORITMA ASLI (REAL) ---
        
        function generateItems() {
            const n = parseInt(document.getElementById('demoN').value);
            const container = document.getElementById('itemsContainer');
            container.innerHTML = '';
            for (let i = 0; i < n; i++) {
                container.innerHTML += `
                    <div class="mini-card">
                        <strong>Barang ${i+1}</strong><br>
                        <input type="number" id="w${i}" value="${Math.floor(Math.random()*20)+5}" placeholder="Berat">
                        <input type="number" id="v${i}" value="${Math.floor(Math.random()*100)+20}" placeholder="Nilai">
                    </div>`;
            }
        }

        function getItemsData() {
            const n = parseInt(document.getElementById('demoN').value);
            const weights = [], values = [];
            for(let i=0; i<n; i++){
                weights.push(parseInt(document.getElementById(`w${i}`).value)||0);
                values.push(parseInt(document.getElementById(`v${i}`).value)||0);
            }
            return {weights, values, n};
        }

        // Algoritma Rekursif Asli
        function knapsackRecursive(W, weights, values, n) {
            if (n === 0 || W === 0) return 0;
            if (weights[n - 1] > W) return knapsackRecursive(W, weights, values, n - 1);
            return Math.max(
                values[n - 1] + knapsackRecursive(W - weights[n - 1], weights, values, n - 1),
                knapsackRecursive(W, weights, values, n - 1)
            );
        }

        // Algoritma Iteratif Asli
        function knapsackIterative(W, weights, values, n) {
            const dp = Array(n + 1).fill(null).map(() => Array(W + 1).fill(0));
            for (let i = 1; i <= n; i++) {
                for (let w = 1; w <= W; w++) {
                    if (weights[i - 1] <= w) {
                        dp[i][w] = Math.max(values[i - 1] + dp[i - 1][w - weights[i - 1]], dp[i - 1][w]);
                    } else {
                        dp[i][w] = dp[i - 1][w];
                    }
                }
            }
            // Backtracking
            let res = dp[n][W], w = W, selected = [];
            for (let i = n; i > 0 && res > 0; i--) {
                if (res !== dp[i - 1][w]) {
                    selected.push(i - 1);
                    res -= values[i - 1];
                    w -= weights[i - 1];
                }
            }
            return { maxValue: dp[n][W], selected: selected };
        }

        function runRealAlgorithm() {
            const {weights, values, n} = getItemsData();
            const W = parseInt(document.getElementById('demoCapacity').value);
            
            // Ukur Waktu Rekursif
            let t0 = performance.now();
            let resRec = knapsackRecursive(W, weights, values, n);
            let timeRec = performance.now() - t0;

            // Ukur Waktu Iteratif
            let t1 = performance.now();
            let resIter = knapsackIterative(W, weights, values, n);
            let timeIter = performance.now() - t1;

            document.getElementById('realResults').innerHTML = `
                <div class="result-card">
                    <h3>Rekursif (Real)</h3>
                    <div class="result-value">${timeRec.toFixed(4)} ms</div>
                    <p>Total Nilai: ${resRec}</p>
                </div>
                <div class="result-card" style="background: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);">
                    <h3>Iteratif (Real)</h3>
                    <div class="result-value">${timeIter.toFixed(4)} ms</div>
                    <p>Total Nilai: ${resIter.maxValue}</p>
                </div>
                <div class="selected-items" style="grid-column: 1 / -1;">
                    <strong>Barang Terpilih (Solusi Optimal):</strong> Barang ${resIter.selected.map(i=>i+1).join(', ')}
                </div>
            `;
        }

        // --- LOGIKA SIMULASI (BENCHMARK) ---

        
        function updateChart(labels, rec, iter) {
            const ctx = document.getElementById('timeChart').getContext('2d');
            if(chart) chart.destroy();
            chart = new Chart(ctx, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [
                        { label: 'Rekursif O(2^n)', data: rec, borderColor: '#FF6384', tension: 0.3 },
                        { label: 'Iteratif O(n×W)', data: iter, borderColor: '#36A2EB', tension: 0.3 }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    scales: {
                        y: { type: 'logarithmic', title: {display:true, text:'Waktu (Log Scale)'}, ticks: { callback: v => Number(v).toLocaleString() } },
                        x: { title: {display:true, text:'Jumlah Barang (N)'} }
                    }
                }
            });
        }

        window.onload = generateItems;
    </script>
</body>
</html><script>
const TIME_PER_OP = 0.000001; // konstanta simulasi (ms)
let chart = null;

function formatTime(ms) {
    if (ms < 1) return ms.toFixed(6) + " ms";
    if (ms < 1000) return ms.toFixed(2) + " ms";
    let sec = ms / 1000;
    if (sec < 60) return sec.toFixed(2) + " detik";
    let min = sec / 60;
    return min.toFixed(2) + " menit";
}

async function runBenchmarkSimulation() {
    const startN = parseInt(document.getElementById('startN').value);
    const endN = parseInt(document.getElementById('endN').value);
    const W = parseInt(document.getElementById('simCapacity').value);
    const table = document.getElementById('comparisonBody');

    if (startN >= endN) {
        alert("Rentang N tidak valid");
        return;
    }

    document.getElementById('loading').classList.add('active');
    table.innerHTML = "";

    let labels = [];
    let dataRec = [];
    let dataIter = [];

    // step adaptif biar 1–10000 tetap ringan
    let step = endN > 1000 ? 100 : 1;

    for (let n = startN; n <= endN; n += step) {

        let timeRec = Math.pow(2, n / 5) * TIME_PER_OP;
        // Iteratif O(n × W)
        let timeIter = n * W * TIME_PER_OP;

        labels.push(n);
        dataRec.push(timeRec);
        dataIter.push(timeIter);

        table.innerHTML += `
        <tr>
            <td>${n}</td>
            <td style="color:#ff6384;font-weight:bold">${formatTime(timeRec)}</td>
            <td style="color:#36a2eb;font-weight:bold">${formatTime(timeIter)}</td>
            <td>${timeRec > timeIter ? "Iteratif Lebih Efisien" : "Seimbang"}</td>
        </tr>
        `;

        if (n % 500 === 0) await new Promise(r => setTimeout(r, 10));
    }

    document.getElementById('loading').classList.remove('active');
    updateChart(labels, dataRec, dataIter);

    document.getElementById('analysisText').innerHTML = `
    <div style="background:#e7f3ff;padding:20px;border-radius:10px;border-left:5px solid #36a2eb">
        <strong>Analisis:</strong><br>
        Grafik menunjukkan bahwa algoritma rekursif memiliki pertumbuhan waktu eksponensial,
        sedangkan algoritma iteratif meningkat secara linear.
        Pada N besar (≥1000), algoritma rekursif menjadi tidak efisien dan tidak layak digunakan.
    </div>`;
}

function updateChart(labels, rec, iter) {
    const ctx = document.getElementById('timeChart').getContext('2d');
    if (chart) chart.destroy();

    chart = new Chart(ctx, {
        type: 'line',
        data: {
            labels: labels,
            datasets: [
                {
                    label: 'Rekursif (O(2ⁿ) – Estimasi)',
                    data: rec,
                    borderColor: '#ff6384',
                    tension: 0.3
                },
                {
                    label: 'Iteratif (O(n×W))',
                    data: iter,
                    borderColor: '#36a2eb',
                    tension: 0.3
                }
            ]
        },
        options: {
            responsive: true,
            maintainAspectRatio: false,
            scales: {
                y: {
                    type: 'logarithmic',
                    title: { display: true, text: 'Waktu Eksekusi (Log Scale)' }
                },
                x: {
                    title: { display: true, text: 'Jumlah Barang (n)' }
                }
            }
        }
    });
}
</script>
